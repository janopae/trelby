app-id: com.github.limburgher.trelby.Devel
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk
command: trelby
finish-args:
    - --socket=x11 # wxWidgets should be able to use Wayland, but in the Flatpak, it still tries to use X for some reason...
    - --filesystem=host # we don't use portals for opening files yet (wxWidgets does not support that). In this situation, filesystem=host is the only responsible solution in order to not create problems when accessing files on removable drives etc.
modules:
  - "pypi-dependencies.flatpak-manifest.yaml"
  - name: trelby
    buildsystem: simple
    build-commands:
      - python3 -m venv /app # To make sure all python paths are in /app, we need to create a virtual environment
      - /app/bin/python3 setup.py install --prefix /app --install-lib="/app/lib/python{py_version_short}/site-packages/" # install-lib gets set to a non-default value in setup.cfg, so we need to overwrite it
    sources:
      - type: dir
        path: .
